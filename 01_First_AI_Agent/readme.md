

# First_AI_Agent

เวิร์กโฟลว์นี้เป็นตัวอย่างการสร้าง **AI Agent** อย่างง่ายใน n8n เพื่อรับข้อความแชทและตอบกลับโดยใช้โมเดลภาษาของ OpenAI พร้อมหน่วยความจำระยะสั้นสำหรับเก็บบริบทการสนทนา

![Alt text](/01_First_AI_Agent/img/01.png)

## คำอธิบาย

Lab นี้แสดงวิธีการออกแบบเวิร์กโฟลว์ใน n8n เพื่อสร้าง AI Agent ที่สามารถประมวลผลข้อความจากผู้ใช้และตอบกลับอย่างชาญฉลาดโดยใช้โมเดล **gpt-4o-mini** จาก OpenAI และหน่วยความจำแบบ window-based เพื่อรักษาบริบทการสนทนา

## โครงสร้างและการทำงาน

เวิร์กโฟลว์ประกอบด้วย 4 โหนดหลักที่เชื่อมต่อกัน ดังนี้:

### 1. When chat message received (`chatTrigger`)
- **หน้าที่**: จุดเริ่มต้นของเวิร์กโฟลว์ รอรับข้อความแชทจากผู้ใช้
- **การตั้งค่า**: ใช้ webhook เพื่อจับข้อความ โดยไม่มีพารามิเตอร์เพิ่มเติม
- **การเชื่อมต่อ**: ส่งข้อมูลไปยังโหนด **AI Agent**

### 2. AI Agent (`agent`)
- **หน้าที่**: ตัวประสานหลักที่จัดการการสนทนา โดยใช้ข้อมูลจากโมเดลภาษาและหน่วยความจำ
- **การตั้งค่า**:
  - ใช้ `promptType: define` เพื่อกำหนดบริบทจาก `sessionId` (`{{ $json.sessionId }}`)
- **การเชื่อมต่อ**:
  - รับข้อมูลจาก **When chat message received**
  - รับโมเดลภาษาจาก **OpenAI Chat Model**
  - รับหน่วยความจำจาก **Simple Memory**

### 3. OpenAI Chat Model (`lmChatOpenAi`)
- **หน้าที่**: เรียกใช้โมเดลภาษา **gpt-4o-mini** จาก OpenAI เพื่อประมวลผลและสร้างคำตอบ
- **การตั้งค่า**:
  - ใช้บัญชี OpenAI ที่กำหนดใน credentials (`openAiApi`)
  - เลือกโมเดล `gpt-4o-mini`
- **การเชื่อมต่อ**: ส่งโมเดลภาษาไปยัง **AI Agent**

### 4. Simple Memory (`memoryBufferWindow`)
- **หน้าที่**: เก็บประวัติการสนทนาแบบระยะสั้น (window-based) เพื่อให้ AI Agent รักษาบริบทได้
- **การตั้งค่า**: ใช้ค่าเริ่มต้น ไม่มีการกำหนดพารามิเตอร์เพิ่มเติม
- **การเชื่อมต่อ**: ส่งข้อมูลหน่วยความจำไปยัง **AI Agent**

## การไหลของข้อมูล
1. ผู้ใช้ส่งข้อความแชท โหนด **When chat message received** จับข้อความและส่งต่อไปยัง **AI Agent**
2. **AI Agent** รับข้อความและใช้ `sessionId` เพื่อกำหนดบริบท
3. **AI Agent** ดึงโมเดลภาษาจาก **OpenAI Chat Model** และหน่วยความจำจาก **Simple Memory** เพื่อประมวลผล
4. **AI Agent** สร้างคำตอบโดยอิงจาก **gpt-4o-mini** และบริบทจากหน่วยความจำ แล้วส่งคำตอบกลับผู้ใช้

## การตั้งค่าเพิ่มเติม
- **สถานะ**: ปิดใช้งาน (`active: false`)
- **การเรียงลำดับการทำงาน**: ใช้ `executionOrder: v1`
- **ข้อมูลเมตา**: มีการกำหนด `instanceId` และยืนยันว่า credentials สำหรับ OpenAI ตั้งค่าเรียบร้อย (`templateCredsSetupCompleted: true`)

## วัตถุประสงค์
เวิร์กโฟลว์นี้มีจุดมุ่งหมายเพื่อ:
- แสดงการสร้าง AI Agent พื้นฐานใน n8n
- ฝึกการรับข้อความจากผู้ใช้และตอบกลับโดยใช้โมเดลภาษาของ OpenAI
- เรียนรู้การใช้หน่วยความจำระยะสั้นเพื่อรักษาบริบทการสนทนา

## การใช้งาน
เหมาะสำหรับผู้เริ่มต้นที่ต้องการเรียนรู้การทำงานของ AI Agent ใน n8n และการผสานกับโมเดลภาษาภายนอกอย่าง OpenAI

## หมายเหตุ
- ต้องตั้งค่า credentials สำหรับ OpenAI ก่อนใช้งาน
- โมเดล **gpt-4o-mini** ถูกเลือกเพื่อประสิทธิภาพและความรวดเร็ว
- สามารถปรับแต่งพารามิเตอร์เพิ่มเติมเพื่อรองรับกรณีใช้งานที่ซับซ้อนมากขึ้น